<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é±¼ç›†è¶‹åŠ¿æ¨¡å‹v2.0 - {{ date }}</title>
    <link rel="stylesheet" href="../css/style.css">

    {% if analytics_enabled and ga_measurement_id %}
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ ga_measurement_id }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ ga_measurement_id }}');
    </script>
    <!-- End Google Analytics -->
    {% endif %}
</head>

<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>é±¼ç›†è¶‹åŠ¿æ¨¡å‹v2.0ã€€æ—¥æœŸï¼š{{ date }}</h1>
            <div class="update-type">ç›˜åå½’æ¡£</div>
        </div>

        <p class="disclaimer">æ•°æ®ä»…ä¾›å¸‚åœºé£æ ¼è¶‹åŠ¿åˆ†æï¼Œä¸æä¾›æŠ•èµ„å»ºè®®</p>

        <!-- å¤šç©ºPKä»ªè¡¨ç›˜ -->
        <div class="bull-bear-dashboard">
            <div class="bull-bear-bar">
                <div class="bar-labels">
                    <span class="bear-label">ç©ºå¤´ {{ bear_ratio }}%</span>
                    <span class="vs">VS</span>
                    <span class="bull-label">{{ bull_ratio }}% å¤šå¤´</span>
                </div>
                <div class="bar-container">
                    <div class="bear-section" style="width: {{ bear_ratio }}%"></div>
                    <div class="bull-section" style="width: {{ bull_ratio }}%"></div>
                </div>
            </div>
        </div>

        <!-- å¯¼èˆªé“¾æ¥ -->
        <div class="nav-links">
            <a href="../index.html">ğŸ  è¿”å›é¦–é¡µ</a>
            <a href="index.html">ğŸ“ å½’æ¡£åˆ—è¡¨</a>
        </div>

        <!-- ä¸»è¦æŒ‡æ•°æ¨¡å— -->
        <h2 class="module-title">ä¸»è¦æŒ‡æ•° <button class="help-btn" onclick="openColumnHelp()">åˆ—è¯´æ˜ <span class="help-btn-icon">?</span></button></h2>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>è¶‹åŠ¿å¼ºåº¦</th>
                        <th>ä»£ç </th>
                        <th>åç§°</th>
                        <th>çŠ¶æ€</th>
                        <th>æ¶¨å¹…%</th>
                        <th>ç°ä»·</th>
                        <th>ä¸´ç•Œå€¼ç‚¹</th>
                        <th>åç¦»ç‡</th>
                        <th>çŠ¶æ€è½¬å˜æ—¶é—´</th>
                        <th>åŒºé—´æ¶¨å¹…%</th>
                        <th>å¼ºåº¦å˜åŒ–</th>
                        <th>èµ°åŠ¿</th>
                        <th>å‘¨æœˆçŠ¶æ€</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in major_indices %}
                    <tr>
                        <td>{{ item.rank }}{% if item.extreme_trend == "æå¼º" %} <span class="extreme-strong">æå¼º</span>{% elif item.extreme_trend == "æå¼±" %} <span class="extreme-weak">æå¼±</span>{% endif %}</td>
                        <td>{{ item.code }}</td>
                        <td>{{ item.name }}</td>
                        {% if item.error %}
                        <td class="status-error" colspan="10">{{ item.error }}</td>
                        {% else %}
                        <td
                            class="{{ 'status-yes' if item.status == 'YES' else 'status-no' }}{% if item.status_change %} pulse{% endif %}">
                            {{ item.status }}
                            {% if item.status_change == 'new_breakthrough' %} ğŸ”¼{% endif %}
                            {% if item.status_change == 'new_breakdown' %} ğŸ”½{% endif %}
                        </td>
                        <td class="{{ 'change-positive' if item.change >= 0 else 'change-negative' }}">{{
                            '%+.2f'|format(item.change) }}%</td>
                        <td>{{ '%.2f'|format(item.current_price) }}</td>
                        <td>{{ '%.2f'|format(item.ma20) }}</td>
                        <td class="{{ 'change-positive' if item.deviation >= 0 else 'change-negative' }}">{{
                            '%.2f'|format(item.deviation) }}%</td>
                        <td>{{ item.change_date_str if item.change_date_str else 'æœªæŸ¥è¯¢åˆ°' }}</td>
                        <td
                            class="{{ 'change-positive' if item.interval_change and item.interval_change >= 0 else 'change-negative' }}">
                            {% if item.interval_change is not none %}
                            {{ '%.2f'|format(item.interval_change) }}%
                            {% else %}
                            -
                            {% endif %}
                        </td>
                        <td
                            class="{% if item.rank_change is not none %}{% if item.rank_change > 0 %}change-positive{% elif item.rank_change < 0 %}change-negative{% endif %}{% endif %}">
                            {% if item.rank_change is not none %}
                            {% if item.rank_change > 0 %}+{% endif %}{{ item.rank_change }}
                            {% else %}
                            -
                            {% endif %}
                        </td>
                        <td class="sparkline-cell">{{ item.sparkline_svg|safe }}</td>
                        <td>
                            {% set parts = item.big_cycle_status.split('-') %}
                            <span
                                class="{{ 'status-yes' if parts[0] == 'YES' else ('status-no' if parts[0] == 'NO' else '') }}">{{
                                parts[0] }}</span>-<span
                                class="{{ 'status-yes' if parts[1] == 'YES' else ('status-no' if parts[1] == 'NO' else '') }}">{{
                                parts[1] }}</span>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- æ¿å—è½®åŠ¨æ¨¡å— -->
        <h2 class="module-title">æ¿å—è½®åŠ¨æ•°æ®ã€€æ—¥æœŸï¼š{{ date }} <button class="help-btn" onclick="openColumnHelp()">åˆ—è¯´æ˜ <span class="help-btn-icon">?</span></button></h2>
        <p class="disclaimer">æ•°æ®ä»…ä¾›å¸‚åœºæ¿å—è¶‹åŠ¿åˆ†æï¼Œä¸æä¾›æŠ•èµ„å»ºè®®</p>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>è¶‹åŠ¿å¼ºåº¦</th>
                        <th>ä»£ç </th>
                        <th>åç§°</th>
                        <th>çŠ¶æ€</th>
                        <th>æ¶¨å¹…%</th>
                        <th>ç°ä»·</th>
                        <th>ä¸´ç•Œå€¼ç‚¹</th>
                        <th>åç¦»ç‡</th>
                        <th>çŠ¶æ€è½¬å˜æ—¶é—´</th>
                        <th>åŒºé—´æ¶¨å¹…%</th>
                        <th>å¼ºåº¦å˜åŒ–</th>
                        <th>èµ°åŠ¿</th>
                        <th>å‘¨æœˆçŠ¶æ€</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in sector_indices %}
                    <tr>
                        <td>{{ item.rank }}{% if item.extreme_trend == "æå¼º" %} <span class="extreme-strong">æå¼º</span>{% elif item.extreme_trend == "æå¼±" %} <span class="extreme-weak">æå¼±</span>{% endif %}</td>
                        <td>{{ item.code }}</td>
                        <td>{{ item.name }}</td>
                        {% if item.error %}
                        <td class="status-error" colspan="10">{{ item.error }}</td>
                        {% else %}
                        <td
                            class="{{ 'status-yes' if item.status == 'YES' else 'status-no' }}{% if item.status_change %} pulse{% endif %}">
                            {{ item.status }}
                            {% if item.status_change == 'new_breakthrough' %} ğŸ”¼{% endif %}
                            {% if item.status_change == 'new_breakdown' %} ğŸ”½{% endif %}
                        </td>
                        <td class="{{ 'change-positive' if item.change >= 0 else 'change-negative' }}">{{
                            '%+.2f'|format(item.change) }}%</td>
                        <td>{{ '%.2f'|format(item.current_price) }}</td>
                        <td>{{ '%.2f'|format(item.ma20) }}</td>
                        <td class="{{ 'change-positive' if item.deviation >= 0 else 'change-negative' }}">{{
                            '%.2f'|format(item.deviation) }}%</td>
                        <td>{{ item.change_date_str if item.change_date_str else 'æœªæŸ¥è¯¢åˆ°' }}</td>
                        <td
                            class="{{ 'change-positive' if item.interval_change and item.interval_change >= 0 else 'change-negative' }}">
                            {% if item.interval_change is not none %}
                            {{ '%.2f'|format(item.interval_change) }}%
                            {% else %}
                            -
                            {% endif %}
                        </td>
                        <td
                            class="{% if item.rank_change is not none %}{% if item.rank_change > 0 %}change-positive{% elif item.rank_change < 0 %}change-negative{% endif %}{% endif %}">
                            {% if item.rank_change is not none %}
                            {% if item.rank_change > 0 %}+{% endif %}{{ item.rank_change }}
                            {% else %}
                            -
                            {% endif %}
                        </td>
                        <td class="sparkline-cell">{{ item.sparkline_svg|safe }}</td>
                        <td>
                            {% set parts = item.big_cycle_status.split('-') %}
                            <span
                                class="{{ 'status-yes' if parts[0] == 'YES' else ('status-no' if parts[0] == 'NO' else '') }}">{{
                                parts[0] }}</span>-<span
                                class="{{ 'status-yes' if parts[1] == 'YES' else ('status-no' if parts[1] == 'NO' else '') }}">{{
                                parts[1] }}</span>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- é¡µè„š -->
        <div class="footer">
            <p>Powered by AkShare | å½’æ¡£æ—¶é—´ï¼š{{ update_time }}</p>
        </div>
    </div>

    <!-- åˆ—è¯´æ˜å¼¹çª— -->
    <div id="columnHelpModal" class="modal" onclick="closeColumnHelp(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>åˆ—è¯´æ˜</h3>
                <button class="modal-close" onclick="closeColumnHelp()">&times;</button>
            </div>
            <div class="modal-body">
                <table class="help-table">
                    <tr><th>è¶‹åŠ¿å¼ºåº¦</th><td>æŒ‰åç¦»ç‡æ’åºçš„æ’åï¼Œæ•°å­—è¶Šå°è¶‹åŠ¿è¶Šå¼ºã€‚æå¼º/æå¼± = è¿ç»­3æ—¥æœªè§¦ç¢°MA20</td></tr>
                    <tr><th>ä»£ç </th><td>æŒ‡æ•°ä»£ç </td></tr>
                    <tr><th>åç§°</th><td>æŒ‡æ•°åç§°</td></tr>
                    <tr><th>çŠ¶æ€</th><td>æ”¶ç›˜ä»·ä¸MA20çš„ä½ç½®ï¼šYESï¼ˆä¸Šæ–¹ï¼‰ã€NOï¼ˆä¸‹æ–¹ï¼‰ã€‚ğŸ”¼çªç ´ ğŸ”½è·Œç ´</td></tr>
                    <tr><th>æ¶¨å¹…%</th><td>å½“æ—¥æ¶¨è·Œå¹…</td></tr>
                    <tr><th>ç°ä»·</th><td>æœ€æ–°æ”¶ç›˜ä»·</td></tr>
                    <tr><th>ä¸´ç•Œå€¼ç‚¹</th><td>MA20å‡çº¿å€¼</td></tr>
                    <tr><th>åç¦»ç‡</th><td>(ç°ä»· - MA20) / MA20ï¼Œè¡¡é‡åç¦»ç¨‹åº¦</td></tr>
                    <tr><th>çŠ¶æ€è½¬å˜æ—¶é—´</th><td>æœ€è¿‘ä¸€æ¬¡çŠ¶æ€è½¬å˜çš„æ—¥æœŸ</td></tr>
                    <tr><th>åŒºé—´æ¶¨å¹…%</th><td>è‡ªçŠ¶æ€è½¬å˜ä»¥æ¥çš„ç´¯è®¡æ¶¨è·Œå¹…</td></tr>
                    <tr><th>å¼ºåº¦å˜åŒ–</th><td>è¶‹åŠ¿å¼ºåº¦æ’åçš„å˜åŒ–</td></tr>
                    <tr><th>èµ°åŠ¿</th><td>è¿‘20æ—¥ä»·æ ¼èµ°åŠ¿å›¾</td></tr>
                    <tr><th>å‘¨æœˆçŠ¶æ€</th><td>å‘¨çº¿-æœˆçº¿ä¸MA20çš„ä½ç½®çŠ¶æ€</td></tr>
                </table>
            </div>
        </div>
    </div>

    <script>
    function openColumnHelp() {
        document.getElementById('columnHelpModal').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function closeColumnHelp(event) {
        if (!event || event.target.id === 'columnHelpModal' || event.target.classList.contains('modal-close')) {
            document.getElementById('columnHelpModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    }

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeColumnHelp();
    });
    </script>
</body>

</html>